---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const linksData = await getCollection('links');

// Group links by category
const grouped: Record<string, typeof linksData> = {};
for (const link of linksData) {
  const cat = link.data.category;
  if (!grouped[cat]) grouped[cat] = [];
  grouped[cat].push(link);
}

const categoryColors: Record<string, string> = {
  reading: 'cat-pink',
  tools: 'cat-green',
  inspiration: 'cat-yellow',
  general: 'cat-lavender',
};
---

<BaseLayout title="Links â€” Portfolio" description="Bookmarks and things worth sharing">
  <section class="page-header">
    <h1>Links</h1>
    <p>Bookmarks, recommendations, and things I keep coming back to.</p>
  </section>

  {Object.entries(grouped).map(([category, links]) => (
    <section class="link-group">
      <h2 class={`category-heading ${categoryColors[category] || 'cat-lavender'}`}>
        {category}
      </h2>
      <ul class="link-list">
        {links.map((link) => (
          <li class="link-item">
            <a href={link.data.url} target="_blank" rel="noopener noreferrer" class="link-card">
              <span class="link-title">{link.data.title} <span class="external-icon">&nearr;</span></span>
              {link.data.description && (
                <span class="link-desc">{link.data.description}</span>
              )}
            </a>
          </li>
        ))}
      </ul>
    </section>
  ))}
</BaseLayout>

<style>
  .page-header {
    padding: var(--space-lg) 0 var(--space-xl);
  }

  .page-header h1 {
    margin-bottom: var(--space-xs);
  }

  .page-header p {
    color: var(--text-light);
  }

  .link-group {
    margin-bottom: var(--space-xl);
  }

  .category-heading {
    font-size: 0.85rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    padding-bottom: var(--space-sm);
    margin-bottom: var(--space-md);
    border-bottom: 2px solid var(--border);
  }

  .cat-pink { border-bottom-color: var(--pink); }
  .cat-green { border-bottom-color: var(--green); }
  .cat-yellow { border-bottom-color: var(--yellow); }
  .cat-lavender { border-bottom-color: var(--lavender); }

  .link-list {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
  }

  .link-item {
    border-radius: var(--radius);
    transition: background-color 0.15s ease;
  }

  .link-item:hover {
    background-color: var(--green-light);
  }

  .link-card {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
    padding: var(--space-sm) var(--space-md);
    text-decoration: none;
  }

  .link-title {
    font-family: var(--font-heading);
    font-weight: 600;
    color: var(--text-heading);
  }

  .external-icon {
    font-size: 0.8em;
    opacity: 0.5;
  }

  .link-desc {
    font-size: 0.9rem;
    color: var(--text-light);
  }
</style>
